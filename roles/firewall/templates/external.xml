<?xml version="1.0" encoding="utf-8"?>
<zone target="DROP">
  <short>External</short>
  <description>For use on external networks. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.</description>
  <interface name="{{ wan_iface }}"/>
  <masquerade/>
  {% for port_forward in port_forwards %}
  <!-- {{ port_forward.description }} -->
  <rule family="ipv4">
    <source address="{{ port_forward.address_from }}"/>
    <port port="{{ port_forward.ports_from }}" protocol="{{ port_forward.proto }}"/>
    <accept/>
  </rule>
  <forward-port port="{{ port_forward.ports_from }}" protocol="{{ port_forward.proto }}" to-port="{{ port_forward.ports_to }}" to-addr="{{ port_forward.address_to }}"/>
  {% endfor %}

  <icmp-block-inversion/>
  <icmp-block name="neighbour-advertisement"/>
  <icmp-block name="neighbour-solicitation"/>
  <protocol value="ipv6-icmp" />
  <protocol value="dhcpv6-client" />
</zone>
